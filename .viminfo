# This viminfo file was generated by Vim 9.1.
# You may edit it if you're careful!

# Viminfo version
|1,4

# Value of 'encoding' when this file was written
*encoding=utf-8


# hlsearch on (H) or off (h):
~h
# Last Search Pattern:
~Msle0~/\<gcloud\>

# Last Substitute Search Pattern:
~MSle0&^

# Last Substitute String:
$# 

# Command Line History (newest to oldest):
:wq
|2,0,1732807304,,"wq"
:q!
|2,0,1732792193,,"q!"
:wq!
|2,0,1732643169,,"wq!"
:'<,'>s/^/# /
|2,0,1732643003,,"'<,'>s/^/# /"
:ww
|2,0,1732612435,,"ww"

# Search String History (newest to oldest):
? \<gcloud\>
|2,1,1732786480,,"\\<gcloud\\>"
? \<source\>
|2,1,1732648107,,"\\<source\\>"
? \<creating\>
|2,1,1732643216,,"\\<creating\\>"
? ^
|2,1,1732643003,,"^"

# Expression History (newest to oldest):

# Input Line History (newest to oldest):

# Debug Line History (newest to oldest):

# Registers:
""1	LINE	0
	       gcloud functions deploy gcs-to-pubsub \
	       --runtime=python312 \
	       --trigger-resource=$bucket_name \
	       --trigger-event=google.storage.object.finalize \
	       --entry-point=gcs_trigger \
	       --source=. \
	       --timeout=300s \
	       --set-env-vars PROJECT_ID=$project_name,TOPIC_ID=$topic_name,SENDGRID_API_KEY=$API_KEY
	
	
	      if [ $? -ne 0 ]; then
	        echo " failed to create the cloud function"
	        exit 1
	      else
	        echo "cloud fucntion created successfully"
	      fi
	
|3,1,1,1,17,0,1732786363,"       gcloud functions deploy gcs-to-pubsub \\","       --runtime=python312 \\","       --trigger-resource=$bucket_name \\","       --trigger-event=google.storage.object.finalize \\","       --entry-point=gcs_trigger \\","       --source=. \\","       --timeout=300s \\","       --set-env-vars PROJECT_ID=$project_name,TOPIC_ID=$topic_name,SENDGRID_API_KEY=$API_KEY","","","      if [ $? -ne 0 ]; then",>55
|<"        echo \" failed to create the cloud function\"","        exit 1","      else","        echo \"cloud fucntion created successfully\"","      fi",""
"2	CHAR	0
	import os
	from sendgrid import SendGridAPIClient
	from sendgrid.helpers.mail import Mail
	import json
	
	 api_key = os.getenv("SENDGRID_API_KEY")
	 if api_key is None:
	     raise ValueError("SENDGRID_API_KEY is not set.")
	
	 # helper function to get the metadata of the object in json format
	   def get_metadata(event, context):
	       file_name = event["name"]
	       bucket_name = event["bucket"]
	
	       message = {"file":file_name, "bucket":bucket_name, "message":"An object was created"}
	       return json.dumps(message, indent=4)
	
	 # main function to send the email
	   def send_email(event, context):
	    #getting the metadata from the helper function
	       metadata = get_metadata(event, context)
	
	    # setting the email details
	       from_email = 'das03285@gmail.com'
	       to_email = 'arijitdas2197@gmail.com'
	       subject = 'GCS Object creation notification'
	       content = f"An object was created in your bucket.Here are the details: \n\n{metadata}"
	
	    # creating the sendmail mail object
	       message = Mail(
	            from_email=from_email,
	            to_emails=to_email,
	            subject=subject,
	            plain_text_content=content
	       )
	
	    # sending the email
	      try:
	         sg = SendGridAPIClient(api_key)
	         response = sg.send(message)
	         print(f"Email send successfuly!! Response status: {response.status_code}")
	      except Exception as e:
	         print(f"Error sending Email {e}")
	
|3,0,2,0,44,0,1732699130,"import os","from sendgrid import SendGridAPIClient","from sendgrid.helpers.mail import Mail","import json",""," api_key = os.getenv(\"SENDGRID_API_KEY\")"," if api_key is None:","     raise ValueError(\"SENDGRID_API_KEY is not set.\")",""," # helper function to get the metadata of the object in json format","   def get_metadata(event, context):","       file_name = event[\"name\"]","       bucket_name = event[\"bucket\"]","",>102
|<"       message = {\"file\":file_name, \"bucket\":bucket_name, \"message\":\"An object was created\"}","       return json.dumps(message, indent=4)",""," # main function to send the email","   def send_email(event, context):","    #getting the metadata from the helper function","       metadata = get_metadata(event, context)","","    # setting the email details","       from_email = 'das03285@gmail.com'","       to_email = 'arijitdas2197@gmail.com'",>53
|<"       subject = 'GCS Object creation notification'","       content = f\"An object was created in your bucket.Here are the details: \\n\\n{metadata}\"","","    # creating the sendmail mail object","       message = Mail(","            from_email=from_email,","            to_emails=to_email,","            subject=subject,","            plain_text_content=content","       )","","    # sending the email","      try:","         sg = SendGridAPIClient(api_key)",>38
|<"         response = sg.send(message)","         print(f\"Email send successfuly!! Response status: {response.status_code}\")","      except Exception as e:","         print(f\"Error sending Email {e}\")",""
"3	CHAR	0
	   
	  from google.cloud import pubsub_v1
	  import json
	  import os
	
	  # creating the needed variables
	  publisher = pubsub_v1.PublisherClient()
	  project = os.getenv("PROJECT_ID")
	  topic = os.getenv("TOPIC_ID")
	  topic_path = publisher.topic_path(project, topic)
	
	  # making the triggerable function
	  def gcs_trigger(event, context):
	
	    # getting the file and bucket details from the event
	      file_name = event['name']
	      bucket_name = event['bucket']
	
	      if not file_name or not bucket_name:
	          print(f"missing metadata from the event")
	          return
	    
	    # making a message to display during triggering in proper json format and encoded
	      message = {"file":file_name, "bucket":bucket_name, "message":"A new object was created"}
	      message_json = json.dumps(message).encode("utf-8")
	
	    # publishing the message with the pre-made topic to the pub/sub
	      try:
	          future = publisher.publish(topic_path, message_json)
	          print(f"Message published: {future.result()}")
	      except Exception as e:
	          print(f"Error Publishing Message: {e})
	
|3,0,3,0,33,0,1732698624,"   ","  from google.cloud import pubsub_v1","  import json","  import os","","  # creating the needed variables","  publisher = pubsub_v1.PublisherClient()","  project = os.getenv(\"PROJECT_ID\")","  topic = os.getenv(\"TOPIC_ID\")","  topic_path = publisher.topic_path(project, topic)","","  # making the triggerable function","  def gcs_trigger(event, context):","","    # getting the file and bucket details from the event",>33
|<"      file_name = event['name']","      bucket_name = event['bucket']","","      if not file_name or not bucket_name:","          print(f\"missing metadata from the event\")","          return","    ","    # making a message to display during triggering in proper json format and encoded","      message = {\"file\":file_name, \"bucket\":bucket_name, \"message\":\"A new object was created\"}","      message_json = json.dumps(message).encode(\"utf-8\")","",>69
|<"    # publishing the message with the pre-made topic to the pub/sub","      try:","          future = publisher.publish(topic_path, message_json)","          print(f\"Message published: {future.result()}\")","      except Exception as e:","          print(f\"Error Publishing Message: {e})",""
"-	CHAR	0
	s
|3,0,36,0,1,0,1732694112,"s"

# File marks:
'0  171  8  ~/bucket_trigger.sh
|4,48,171,8,1732807304,"~/bucket_trigger.sh"
'1  67  27  ~/main.py
|4,49,67,27,1732805772,"~/main.py"
'2  67  27  ~/main.py
|4,50,67,27,1732805772,"~/main.py"
'3  61  10  ~/main.py
|4,51,61,10,1732805412,"~/main.py"
'4  61  10  ~/main.py
|4,52,61,10,1732805412,"~/main.py"
'5  61  10  ~/main.py
|4,53,61,10,1732805412,"~/main.py"
'6  61  10  ~/main.py
|4,54,61,10,1732805412,"~/main.py"
'7  61  11  ~/main.py
|4,55,61,11,1732805012,"~/main.py"
'8  61  11  ~/main.py
|4,56,61,11,1732805012,"~/main.py"
'9  61  11  ~/main.py
|4,57,61,11,1732805012,"~/main.py"

# Jumplist (newest first):
-'  171  8  ~/bucket_trigger.sh
|4,39,171,8,1732807304,"~/bucket_trigger.sh"
-'  155  5  ~/bucket_trigger.sh
|4,39,155,5,1732805794,"~/bucket_trigger.sh"
-'  67  27  ~/main.py
|4,39,67,27,1732805772,"~/main.py"
-'  67  27  ~/main.py
|4,39,67,27,1732805772,"~/main.py"
-'  61  10  ~/main.py
|4,39,61,10,1732805667,"~/main.py"
-'  61  10  ~/main.py
|4,39,61,10,1732805667,"~/main.py"
-'  61  10  ~/main.py
|4,39,61,10,1732805412,"~/main.py"
-'  61  11  ~/main.py
|4,39,61,11,1732805012,"~/main.py"
-'  79  2  ~/main.py
|4,39,79,2,1732804804,"~/main.py"
-'  79  2  ~/main.py
|4,39,79,2,1732804804,"~/main.py"
-'  79  2  ~/main.py
|4,39,79,2,1732804804,"~/main.py"
-'  79  2  ~/main.py
|4,39,79,2,1732804804,"~/main.py"
-'  79  2  ~/main.py
|4,39,79,2,1732803775,"~/main.py"
-'  80  62  ~/main.py
|4,39,80,62,1732803727,"~/main.py"
-'  80  62  ~/main.py
|4,39,80,62,1732803727,"~/main.py"
-'  80  62  ~/main.py
|4,39,80,62,1732803727,"~/main.py"
-'  80  62  ~/main.py
|4,39,80,62,1732803727,"~/main.py"
-'  80  62  ~/main.py
|4,39,80,62,1732803727,"~/main.py"
-'  80  62  ~/main.py
|4,39,80,62,1732803587,"~/main.py"
-'  49  70  ~/main.py
|4,39,49,70,1732803441,"~/main.py"
-'  49  70  ~/main.py
|4,39,49,70,1732803441,"~/main.py"
-'  49  70  ~/main.py
|4,39,49,70,1732803441,"~/main.py"
-'  49  70  ~/main.py
|4,39,49,70,1732803441,"~/main.py"
-'  49  70  ~/main.py
|4,39,49,70,1732803441,"~/main.py"
-'  49  70  ~/main.py
|4,39,49,70,1732803441,"~/main.py"
-'  50  70  ~/main.py
|4,39,50,70,1732802970,"~/main.py"
-'  50  70  ~/main.py
|4,39,50,70,1732802970,"~/main.py"
-'  50  70  ~/main.py
|4,39,50,70,1732802970,"~/main.py"
-'  50  70  ~/main.py
|4,39,50,70,1732802970,"~/main.py"
-'  50  70  ~/main.py
|4,39,50,70,1732802970,"~/main.py"
-'  50  70  ~/main.py
|4,39,50,70,1732802970,"~/main.py"
-'  53  0  ~/main.py
|4,39,53,0,1732802701,"~/main.py"
-'  54  0  ~/main.py
|4,39,54,0,1732802701,"~/main.py"
-'  53  0  ~/main.py
|4,39,53,0,1732802701,"~/main.py"
-'  54  0  ~/main.py
|4,39,54,0,1732802701,"~/main.py"
-'  53  0  ~/main.py
|4,39,53,0,1732802701,"~/main.py"
-'  54  0  ~/main.py
|4,39,54,0,1732802701,"~/main.py"
-'  53  0  ~/main.py
|4,39,53,0,1732802701,"~/main.py"
-'  54  0  ~/main.py
|4,39,54,0,1732802701,"~/main.py"
-'  53  0  ~/main.py
|4,39,53,0,1732802701,"~/main.py"
-'  54  0  ~/main.py
|4,39,54,0,1732802701,"~/main.py"
-'  53  0  ~/main.py
|4,39,53,0,1732802701,"~/main.py"
-'  54  0  ~/main.py
|4,39,54,0,1732802701,"~/main.py"
-'  51  0  ~/main.py
|4,39,51,0,1732792377,"~/main.py"
-'  52  0  ~/main.py
|4,39,52,0,1732792377,"~/main.py"
-'  51  0  ~/main.py
|4,39,51,0,1732792377,"~/main.py"
-'  52  0  ~/main.py
|4,39,52,0,1732792377,"~/main.py"
-'  51  0  ~/main.py
|4,39,51,0,1732792377,"~/main.py"
-'  52  0  ~/main.py
|4,39,52,0,1732792377,"~/main.py"
-'  51  0  ~/main.py
|4,39,51,0,1732792377,"~/main.py"
-'  52  0  ~/main.py
|4,39,52,0,1732792377,"~/main.py"
-'  51  0  ~/main.py
|4,39,51,0,1732792377,"~/main.py"
-'  52  0  ~/main.py
|4,39,52,0,1732792377,"~/main.py"
-'  51  0  ~/main.py
|4,39,51,0,1732792377,"~/main.py"
-'  52  0  ~/main.py
|4,39,52,0,1732792377,"~/main.py"
-'  1  0  ~/main.py
|4,39,1,0,1732792195,"~/main.py"
-'  1  0  ~/main.py
|4,39,1,0,1732792195,"~/main.py"
-'  1  0  ~/main.py
|4,39,1,0,1732792195,"~/main.py"
-'  1  0  ~/main.py
|4,39,1,0,1732792195,"~/main.py"
-'  1  0  ~/main.py
|4,39,1,0,1732792195,"~/main.py"
-'  1  0  ~/main.py
|4,39,1,0,1732792195,"~/main.py"
-'  1  0  ~/main.py
|4,39,1,0,1732792195,"~/main.py"
-'  1  0  ~/main.py
|4,39,1,0,1732792195,"~/main.py"
-'  90  0  ~/main.py
|4,39,90,0,1732792193,"~/main.py"
-'  83  0  ~/main.py
|4,39,83,0,1732792193,"~/main.py"
-'  88  0  ~/main.py
|4,39,88,0,1732792193,"~/main.py"
-'  81  0  ~/main.py
|4,39,81,0,1732792193,"~/main.py"
-'  89  0  ~/main.py
|4,39,89,0,1732792193,"~/main.py"
-'  82  0  ~/main.py
|4,39,82,0,1732792193,"~/main.py"
-'  87  0  ~/main.py
|4,39,87,0,1732792193,"~/main.py"
-'  90  0  ~/main.py
|4,39,90,0,1732792193,"~/main.py"
-'  83  0  ~/main.py
|4,39,83,0,1732792193,"~/main.py"
-'  88  0  ~/main.py
|4,39,88,0,1732792193,"~/main.py"
-'  81  0  ~/main.py
|4,39,81,0,1732792193,"~/main.py"
-'  89  0  ~/main.py
|4,39,89,0,1732792193,"~/main.py"
-'  82  0  ~/main.py
|4,39,82,0,1732792193,"~/main.py"
-'  87  0  ~/main.py
|4,39,87,0,1732792193,"~/main.py"
-'  90  0  ~/main.py
|4,39,90,0,1732792193,"~/main.py"
-'  83  0  ~/main.py
|4,39,83,0,1732792193,"~/main.py"
-'  88  0  ~/main.py
|4,39,88,0,1732792193,"~/main.py"
-'  81  0  ~/main.py
|4,39,81,0,1732792193,"~/main.py"
-'  89  0  ~/main.py
|4,39,89,0,1732792193,"~/main.py"
-'  82  0  ~/main.py
|4,39,82,0,1732792193,"~/main.py"
-'  87  0  ~/main.py
|4,39,87,0,1732792193,"~/main.py"
-'  90  0  ~/main.py
|4,39,90,0,1732792193,"~/main.py"
-'  83  0  ~/main.py
|4,39,83,0,1732792193,"~/main.py"
-'  88  0  ~/main.py
|4,39,88,0,1732792193,"~/main.py"
-'  81  0  ~/main.py
|4,39,81,0,1732792193,"~/main.py"
-'  89  0  ~/main.py
|4,39,89,0,1732792193,"~/main.py"
-'  82  0  ~/main.py
|4,39,82,0,1732792193,"~/main.py"
-'  87  0  ~/main.py
|4,39,87,0,1732792193,"~/main.py"
-'  90  0  ~/main.py
|4,39,90,0,1732792193,"~/main.py"
-'  83  0  ~/main.py
|4,39,83,0,1732792193,"~/main.py"
-'  88  0  ~/main.py
|4,39,88,0,1732792193,"~/main.py"
-'  81  0  ~/main.py
|4,39,81,0,1732792193,"~/main.py"
-'  89  0  ~/main.py
|4,39,89,0,1732792193,"~/main.py"
-'  82  0  ~/main.py
|4,39,82,0,1732792193,"~/main.py"
-'  87  0  ~/main.py
|4,39,87,0,1732792193,"~/main.py"
-'  90  0  ~/main.py
|4,39,90,0,1732792193,"~/main.py"
-'  83  0  ~/main.py
|4,39,83,0,1732792193,"~/main.py"

# History of marks within files (newest to oldest):

> ~/bucket_trigger.sh
	*	1732807301	0
	"	171	8
	^	171	9
	.	31	62
	+	150	6
	+	151	7
	+	152	8
	+	153	5
	+	154	7
	+	155	5
	+	20	26
	+	9	117
	+	10	52
	+	11	82
	+	22	23
	+	68	7
	+	69	2
	+	70	2
	+	71	2
	+	72	2
	+	68	7
	+	73	0
	+	74	0
	+	75	0
	+	76	0
	+	77	0
	+	78	0
	+	79	0
	+	80	0
	+	82	8
	+	76	10
	+	83	8
	+	84	8
	+	88	9
	+	85	0
	+	86	0
	+	87	0
	+	88	0
	+	89	0
	+	90	0
	+	91	0
	+	92	0
	+	93	0
	+	94	0
	+	95	0
	+	96	0
	+	97	0
	+	98	0
	+	99	9
	+	100	0
	+	101	0
	+	102	0
	+	103	0
	+	104	46
	+	26	94
	+	69	42
	+	71	42
	+	84	73
	+	106	55
	+	104	74
	+	111	0
	+	125	0
	+	126	0
	+	134	0
	+	133	10
	+	135	0
	+	125	4
	+	139	60
	+	138	0
	+	136	7
	+	137	6
	+	135	31
	+	129	48
	+	132	51
	+	128	1
	+	118	1
	+	140	7
	+	141	6
	+	142	6
	+	143	7
	+	144	7
	+	145	7
	+	146	6
	+	147	7
	+	150	6
	+	151	7
	+	152	8
	+	154	7
	+	153	5
	+	155	5
	+	106	57
	+	64	37
	+	23	40
	+	24	58
	+	25	28
	+	27	57
	+	28	71
	+	29	60
	+	30	43
	+	32	55
	+	84	38
	+	69	37
	+	84	59
	+	31	62

> ~/main.py
	*	1732805770	0
	"	67	27
	^	67	28
	.	65	27
	+	1	42
	+	1	0
	+	268	49
	+	268	4
	+	243	4
	+	244	0
	+	200	27
	+	201	31
	+	220	21
	+	244	4
	+	220	39
	+	221	46
	+	215	0
	+	221	28
	+	205	0
	+	200	32
	+	201	36
	+	180	42
	+	92	42
	+	47	0
	+	22	0
	+	40	99
	+	41	0
	+	77	0
	+	89	58
	+	81	3
	+	83	3
	+	82	35
	+	81	3
	+	47	14
	+	52	18
	+	6	15
	+	7	12
	+	48	33
	+	49	70
	+	46	18
	+	48	0
	+	80	62
	+	79	3
	+	54	74
	+	57	6
	+	56	7
	+	59	8
	+	60	11
	+	61	11
	+	56	7
	+	57	6
	+	56	42
	+	57	39
	+	56	37
	+	59	8
	+	60	11
	+	61	11
	+	55	0
	+	64	27
	+	65	27

> ~/pubsub_script/main.py
	*	1732698669	0
	"	12	31
	^	12	32
	.	12	31
	+	1	47
	+	1	0
	+	36	47
	+	12	31

> ~/email_script/requirements.txt
	*	1732648847	0
	"	1	0
	^	1	0
	.	1	0
	+	1	0

> ~/pubsub_function.py
	*	1732647556	0
	"	4	1
	^	4	2
	.	4	1
	+	20	57
	+	22	0
	+	21	15
	+	8	9
	+	4	9
	+	20	16
	+	8	33
	+	9	0
	+	8	8
	+	9	28
	+	10	49
	+	25	13
	+	2	1
	+	3	1
	+	4	1

> ~/email_function.py
	*	1732645812	0
	"	44	8
	^	44	9
	.	44	9
	+	46	0
	+	46	9
	+	62	19
	+	51	16
	+	7	40
	+	12	36
	+	13	32
	+	14	33
	+	5	11
	+	3	0
	+	16	93
	+	17	57
	+	20	18
	+	9	52
	+	8	6
	+	20	20
	+	23	0
	+	17	14
	+	20	31
	+	22	17
	+	11	66
	+	19	33
	+	23	6
	+	21	49
	+	25	34
	+	26	0
	+	25	11
	+	26	29
	+	20	3
	+	26	43
	+	27	51
	+	28	93
	+	37	0
	+	31	23
	+	35	33
	+	33	13
	+	34	14
	+	35	13
	+	31	14
	+	30	38
	+	41	33
	+	42	80
	+	43	0
	+	39	9
	+	40	7
	+	41	7
	+	42	7
	+	43	28
	+	44	41
	+	45	0
	+	39	5
	+	43	6
	+	28	81
	+	31	7
	+	41	27
	+	24	22
	+	32	12
	+	33	10
	+	34	12
	+	35	37
	+	37	0
	+	36	6
	+	39	6
	+	43	5
	+	40	8
	+	41	8
	+	42	8
	+	44	9

> ~/requirements.txt
	*	1732544580	0
	"	3	26
	^	3	27
	.	3	26
	+	4	21
	+	2	0
	+	2	20
	+	4	0
	+	2	0
	+	2	20
	+	3	0
	+	4	0
	+	2	27
	+	3	26

> ~/functions.py
	*	1732457385	0
	"	7	79
	^	7	80
	.	7	79
	+	7	1
	+	5	27
	+	7	73
	+	6	1
	+	5	32
	+	9	35
	+	10	34
	+	13	30
	+	14	17
	+	13	15
	+	14	35
	+	26	0
	+	12	55
	+	17	34
	+	17	94
	+	18	44
	+	16	84
	+	18	56
	+	22	62
	+	23	56
	+	25	45
	+	7	79
